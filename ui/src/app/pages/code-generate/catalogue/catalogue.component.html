<form [x-loading]="formLoading()" [formGroup]="form" class="app-dialog-form" (ngSubmit)="save()">
  <h4 x-dialog-title class="title">{{ title() }}</h4>
  <x-button x-dialog-close class="close" icon="fto-x" size="large" flat text></x-button>
  <div x-dialog-content class="content">
    @if (type() !== 'add-root') {
      <div class="item">
        <label>{{ '$codeGenerate.parentNode' | xI18n }}</label>
        <x-tree-select [data]="treeData()" showPath formControlName="pid"></x-tree-select>
      </div>
    }
    <div class="item">
      <label>
        {{ '$codeGenerate.nodeType' | xI18n }}
        <x-icon
          class="app-help-icon"
          x-tooltip
          [content]="contentTypeTpl"
          [panelClass]="'app-help-content'"
          type="fto-help-circle"
        ></x-icon>
        <ng-template #contentTypeTpl>
          <p>{{ '$codeGenerate.folderTypeCanAddChild' | xI18n }}</p>
          <p>{{ '$codeGenerate.fileTypeBaseFileSuffix' | xI18n }}</p>
        </ng-template>
      </label>
      <x-radio
        [data]="[
          { id: 'Folder', label: ('$codeGenerate.folder' | xI18n) },
          { id: 'File', label: ('$codeGenerate.file' | xI18n) }
        ]"
        button
        formControlName="type"
      ></x-radio>
      <x-input formControlName="name" [placeholder]="typeName"></x-input>
    </div>
    @if (form.value.type === 'File') {
      <div class="item required">
        <label>
          {{ '$codeGenerate.generateMultiple' | xI18n }}
          <x-icon
            class="app-help-icon"
            x-tooltip
            [content]="contentManyTpl"
            [panelClass]="'app-help-content'"
            type="fto-help-circle"
          ></x-icon>
          <ng-template #contentManyTpl>
            <p>{{ '$codeGenerate.defaultGenerateOnce' | xI18n }}</p>
            <p>{{ '$codeGenerate.multipleGenerateNeedDefineVariable' | xI18n }}</p>
            <p>{{ '$codeGenerate.dataDefineVariableFromCategoryVariable' | xI18n }}</p>
          </ng-template>
        </label>
        <x-radio
          [data]="[
            { id: true, label: ('$base.yes' | xI18n) },
            { id: false, label: ('$base.no' | xI18n) }
          ]"
          button
          formControlName="many"
        ></x-radio>
        @if (form.value.many) {
          <x-cascade
            [placeholder]="'$codeGenerate.pleaseSelectDataDefineVariable' | xI18n"
            [data]="variableList()"
            nodeTrigger="hover"
            formControlName="variableId"
          ></x-cascade>
        }
      </div>
    }
    <div class="item required">
      <label>{{ '$base.sort' | xI18n }}</label>
      <x-input-number formControlName="sort"></x-input-number>
    </div>

    <div class="item" [style.grid-column]="'1 / -1'">
      <label>{{ '$base.description' | xI18n }}</label>
      <x-textarea
        formControlName="description"
        [placeholder]="'$base.pleaseInputDescription' | xI18n"
      ></x-textarea>
    </div>
  </div>
  <div x-dialog-actions align="center" class="actions">
    <x-button icon="fto-x" attrType="button" flat plain x-dialog-close>{{
      '$base.cancel' | xI18n
    }}</x-button>
    <x-button
      flat
      icon="fto-save"
      type="primary"
      attrType="submit"
      [loading]="saveLoading()"
      [disabled]="!form.valid"
    >
      {{ '$base.save' | xI18n }}
    </x-button>
  </div>
</form>
