<form [x-loading]="formLoading()" [formGroup]="form" class="app-dialog-form" (ngSubmit)="save()">
  <h4 x-dialog-title class="title">{{ '$subject.permissionConfig' | xI18n }}-{{ title() }}</h4>
  <x-button x-dialog-close class="close" icon="fto-x" size="large" flat text></x-button>
  <div x-dialog-content class="content attrs">
    <div class="tools">
      <x-button
        icon="fto-plus"
        [app-auth]="'permission-save-many'"
        attrType="button"
        flat
        plain
        (click)="add()"
        >{{ '$base.add' | xI18n }}</x-button
      >
    </div>
    <div class="attrs-table">
      <table>
        <thead>
          <tr>
            <th>{{ '$base.index' | xI18n }}</th>
            <th width="160">{{ '$subject.permissionName' | xI18n }}</th>
            <th width="200">{{ '$base.code' | xI18n }}</th>
            <th>{{ '$base.sort' | xI18n }}</th>
            <th>{{ '$base.description' | xI18n }}</th>
            <th>{{ '$base.operate' | xI18n }}</th>
          </tr>
        </thead>
        <tbody formArrayName="list">
          @for (item of list.controls; track item) {
            <tr [formGroupName]="$index">
              <td class="index">{{ $index + 1 }}</td>
              <td><x-input formControlName="name"></x-input></td>
              <td>
                <x-input formControlName="code"></x-input>
              </td>
              <td>
                <x-input-number formControlName="sort" [style.width.px]="165"></x-input-number>
              </td>
              <td><x-input formControlName="description"></x-input></td>
              <td>
                <x-button
                  icon="fto-trash-2"
                  attrType="button"
                  flat
                  plain
                  [disabled]="!hasPermissionSaveMany()"
                  (click)="remove($index)"
                >
                  {{ '$base.delete' | xI18n }}
                </x-button>
              </td>
            </tr>
          }
        </tbody>
      </table>
      @if (isEmpty) {
        <div class="empty">
          <x-empty></x-empty>
        </div>
      }
    </div>
  </div>
  <div x-dialog-actions align="center" class="actions">
    <x-button icon="fto-x" attrType="button" flat plain x-dialog-close>{{
      '$base.cancel' | xI18n
    }}</x-button>
    <x-button
      flat
      icon="fto-save"
      type="primary"
      attrType="submit"
      [loading]="saveLoading()"
      [disabled]="!form.valid || !hasPermissionSaveMany()"
      >{{ '$base.save' | xI18n }}</x-button
    >
  </div>
</form>
